<!DOCTYPE html>
<html lang="zh-Hant">
 <head>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <meta charset="utf-8"/>
  <script src="skilldesc.js">
   const attributeMapping = {
  "1": "水",
  "2": "火",
  "3": "木",
  "4": "光",
  "5": "暗"
};

const raceMapping = {
  "1": "人類",
  "2": "獸類",
  "3": "龍類",
  "4": "神族",
  "5": "魔族",
  "6": "機械族",
  "7": "妖精類",
  "8": "強化素材",
  "9": "進化素材"
};
  </script>
  <title>
   神魔圖鑒
  </title>
  <style>
   body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      height: 100vh;
    }
    .gallery {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      justify-items: center;
      width: 100%;
      max-width: 1200px;
      margin-top: 80px;
    }
    .monster {
      width: 142px;
      text-align: center;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #ccc;
    }
    .monster img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      display: block;
      margin: 0 auto 8px;
    }
    .search-bar-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 60px;
      background: #ffffff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      z-index: 999;
      display: flex;
      align-items: center;
    }
    .search-bar {
      width: 25%;
      margin-left: 20px;
      background: #fff;
      padding: 10px 20px;
      box-sizing: border-box;
      border-radius: 6px;
      position: relative;
      z-index: 1000;
    }
    .search-bar input {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .dropdown {
      position: relative;
      margin-left: 10px;
    }
    .dropdown-button {
      background: #fff;
      padding: 8px 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      font-size: 14px;
      cursor: pointer;
      transition: border-color 0.3s;
    }
    .dropdown-button:hover {
      border-color: #888;
    }
    .dropdown-button img {
      width: 24px;
      height: 24px;
      margin-right: 8px;
    }
    .dropdown-content {
      display: none;
      opacity: 0;
      position: absolute;
      top: 100%;
      left: 0;
      background-color: #fff;
      border: 1px solid #ccc;
      box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 1;
      min-width: max-content;
      padding: 4px 0;
      border-radius: 6px;
      transition: opacity 0.3s ease;
    }
    .dropdown-content.show {
      display: block;
      opacity: 1;
    }
    .dropdown-item {
      padding: 6px 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      font-size: 14px;
      transition: background-color 0.2s;
    }
    .dropdown-item:hover {
      background-color: #f0f0f0;
    }
    .dropdown-item img {
      width: 24px;
      height: 24px;
      margin-right: 10px;
    }
    .dropdown-item.selected {
      opacity: 0.4;
      pointer-events: none;
    }
	#scrollButtons {
	  position: fixed;
	  right: 20px;
	  bottom: 20px;
	  display: none;
	  flex-direction: column;
	  gap: 10px;
	  z-index: 999;
	}

	#scrollButtons button {
	  padding: 10px 12px;
	  font-size: 14px;
	  border: none;
	  border-radius: 8px;
	  background-color: #333;
	  color: white;
	  cursor: pointer;
	  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
	  transition: background-color 0.3s ease;
	}

	#scrollButtons button:hover {
	  background-color: #555;
	}
	#resetFilters {
	  padding: 8px;
	  border: none;
	  background: none;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  cursor: pointer;
	}
	#resetFilters img {
	  width: 30px;
	  height: 30px;
	  object-fit: contain;
	}

	.modal-content {
	  position: relative;
	  background-color: #fefefe;
	  margin: 5% auto;
	  padding: 20px;
	  border: 1px solid #888;
	  width: 80%;
	}

	.close {
	  position: absolute;
	  top: 10px;
	  right: 10px;
	  font-size: 28px;
	  color: #aaa;
	  cursor: pointer;
	  transition: color 0.2s;
	  z-index: 10;
	}

	.close:hover {
	  color: #333;
	}

	#monsterInfoContent {
	  display: flex;
	  flex-direction: column;
	  justify-content: flex-start; /* 保持內容在上 */
	  height: 100%; /* 使容器佔據全部高度 */
	  position: relative;
	  /* background-position: center bottom; */
	  /* background-size: cover; */
	}
	#monsterInfoContent > * {
	  position: relative;
	  z-index: 1;
	}
	#monsterInfoContent .content {
	  flex-grow: 1;  /* 使內容區域可以擴展，填滿剩餘空間 */
	}
	.info-row {
	  display: flex;
	  justify-content: space-between;
	  margin: 5px 0;
	}

	.info-label {
	  font-weight: bold;
	  width: 100px;  /* 控制左側的寬度 */
	}

	.info-value {
	  width: 100px;  /* 控制右側的寬度 */
	  text-align: center;  /* 讓數據居中顯示 */
	}

	#monsterInfoContent button {
	  margin-top: auto;
	  padding: 10px 20px;
	  background-color: #333;
	  color: white;
	  border: none;
	  cursor: pointer;
	}

	#monsterInfoContent button:hover {
	  background-color: #555;
	}
  
#monsterInfoContent {
  position: relative;
  width : 100%;
  padding-top: 40px; /* ✅ 預留空間，讓 .close 不會被蓋住 */
  /* background-position: center bottom; */
  /* background-size: cover; */
}
#monsterInfoContent::before {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background-image: var(--monster-bg);
  background-size: auto 60%;
  background-repeat: no-repeat;
  background-position: center center;
  opacity: 0.2; /* 調整透明度 */
  <!--filter: grayscale(40%) blur(2px); /* 讓字更清楚 */-->
  z-index: 0;
}
#monsterInfoContent > * {
  position: relative;
  z-index: 1;
}
#monsterID {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: bold;
}
#monsterID img {
  width: 24px;
  height: 24px;
}
  </style>
 </head>
 <body>
  <div class="search-bar-wrapper">
   <div class="search-bar">
    <input id="searchInput" onkeyup="filterMonsters()" placeholder="輸入卡片編號或名稱..." type="text"/>
   </div>
   <!-- 屬性 -->
   <div class="dropdown" id="attributeDropdown">
    <div class="dropdown-button dropdown-trigger">
     <div class="selected-icons">
     </div>
     <span>
      屬性
     </span>
    </div>
    <div class="dropdown-content" id="attributeContent">
     <div class="dropdown-item" data-value="1">
      <img alt="水" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/water.png"/>
     </div>
     <div class="dropdown-item" data-value="2">
      <img alt="火" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/fire.png"/>
     </div>
     <div class="dropdown-item" data-value="3">
      <img alt="木" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/earth.png"/>
     </div>
     <div class="dropdown-item" data-value="4">
      <img alt="光" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/light.png"/>
     </div>
     <div class="dropdown-item" data-value="5">
      <img alt="暗" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/dark.png"/>
     </div>
    </div>
   </div>
   <!-- 種族 -->
   <div class="dropdown" id="raceDropdown">
    <div class="dropdown-button dropdown-trigger">
     <div class="selected-icons">
     </div>
     <span>
      種族
     </span>
    </div>
    <div class="dropdown-content" id="raceContent">
     <div class="dropdown-item" data-value="1">
      <img alt="人" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/human.png"/>
     </div>
     <div class="dropdown-item" data-value="2">
      <img alt="獸" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/animal.png"/>
     </div>
     <div class="dropdown-item" data-value="3">
      <img alt="妖" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/fairy.png"/>
     </div>
     <div class="dropdown-item" data-value="4">
      <img alt="龍" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/dragon.png"/>
     </div>
     <div class="dropdown-item" data-value="5">
      <img alt="神" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/god.png"/>
     </div>
     <div class="dropdown-item" data-value="8">
      <img alt="魔" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/devil.png"/>
     </div>
     <div class="dropdown-item" data-value="10">
      <img alt="機械" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/mech.png"/>
     </div>
     <div class="dropdown-item" data-value="6">
      <img alt="進化" src="https://i.postimg.cc/zbDvRhPc/evolve.png"/>
     </div>
     <div class="dropdown-item" data-value="7">
      <img alt="強化" src="https://i.postimg.cc/cKB6HhT3/level.png"/>
     </div>
    </div>
   </div>
   <button id="resetFilters" style="margin-left: 10px; padding: 8px 16px;">
    <img src="https://i.postimg.cc/X7SptCXY/SI125.png"/>
   </button>
  </div>
  <div class="gallery" id="monsterGallery">
   <div class="monster" data-attribute="1" data-id="0001" data-name="莫莉" data-normalskill-id="80" data-race="1">
    <div>
     0001
    </div>
    <img alt="0001" onerror="this.onerror=null;this.src='https://kennylou92.github.io/tos_story/Img/default.png';" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/gallery/icons/0001.jpg"/>
    <div>
     莫莉
    </div>
   </div>
   <div class="monster" data-attribute="1" data-id="0002" data-name="高級水術士莫莉" data-normalskill-id="80" data-race="1">
    <div>
     0002
    </div>
    <img alt="0002" onerror="this.onerror=null;this.src='https://kennylou92.github.io/tos_story/Img/default.png';" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/gallery/icons/0002.jpg"/>
    <div>
     高級水術士莫莉
    </div>
   </div>
   <div class="monster" data-attribute="1" data-id="0003" data-name="水魔法師莫莉" data-normalskill-id="80" data-race="1">
    <div>
     0003
    </div>
    <img alt="0003" onerror="this.onerror=null;this.src='https://kennylou92.github.io/tos_story/Img/default.png';" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/gallery/icons/0003.jpg"/>
    <div>
     水魔法師莫莉
    </div>
   </div>
   <div class="monster" data-attribute="1" data-id="0004" data-name="水元素賢者莫莉" data-normalskill-id="104" data-race="1">
    <div>
     0004
    </div>
    <img alt="0004" onerror="this.onerror=null;this.src='https://kennylou92.github.io/tos_story/Img/default.png';" src="https://d1h5mn9kk900cf.cloudfront.net/toswebsites/gallery/icons/0004.jpg"/>
    <div>
     水元素賢者莫莉
    </div>
   </div>
  </div>
  <div id="scrollButtons">
   <button onclick="scrollToTop()">
    <i class="fas fa-angle-up">
    </i>
   </button>
   <button onclick="scrollToBottom()">
    <i class="fas fa-angle-down">
    </i>
   </button>
  </div>
  <!-- Modal for displaying monster info -->
  <div id="monsterInfoModal" style="display:none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); padding-top: 60px;">
   <div class="modal-content">
    <span class="close" onclick="closeModal()">
     <i class="fas fa-times">
     </i>
    </span>
    <div id="monsterInfoContent">
     <div class="content">
      <div id="monsterID">
      </div>
      <div class="info-row">
       <p class="info-label">
        HP:
       </p>
       <p class="info-value" id="monsterHP">
       </p>
       <p class="info-label">
        HP (+20):
       </p>
       <p class="info-value" id="monsterHP1_2">
       </p>
      </div>
      <div class="info-row">
       <p class="info-label">
        ATK:
       </p>
       <p class="info-value" id="monsterATK">
       </p>
       <p class="info-label">
        ATK (+20):
       </p>
       <p class="info-value" id="monsterATK1_2">
       </p>
      </div>
      <div class="info-row">
       <p class="info-label">
        REC:
       </p>
       <p class="info-value" id="monsterREC">
       </p>
       <p class="info-label">
        REC (+20):
       </p>
       <p class="info-value" id="monsterREC1_2">
       </p>
      </div>
      <!--<button onclick="closeModal()">關閉</button>-->
     </div>
    </div>
   </div>
  </div>
  <script>
   function fetchMonsterInfo(monsterId, monsterElement) {
  fetch('monster.json')
    .then(response => response.json())
    .then(data => {
      const monster = data.find(m => m.id === monsterId);
      if (monster) {
        const infoBlock = document.getElementById("monsterInfoContent");
        infoBlock.style.setProperty('--monster-bg', `url('https://d1h5mn9kk900cf.cloudfront.net/toswebsites/gallery/cards/${monsterId}.jpg')`);

        updateMonsterIcons(monsterElement, monster);

        document.getElementById('monsterHP').textContent = monster.HP;
        document.getElementById('monsterATK').textContent = monster.ATK;
        document.getElementById('monsterREC').textContent = monster.REC;

        document.getElementById('monsterHP1_2').textContent = Math.floor(monster.HP * 1.2);
        document.getElementById('monsterATK1_2').textContent = Math.floor(monster.ATK * 1.2);
        document.getElementById('monsterREC1_2').textContent = Math.floor(monster.REC * 1.2);

        // === 🌟 顯示所有 normalskill ===
        {
          let skillIdsRaw = monsterElement.getAttribute("data-normalskill-id") || "";
          let skillIds = skillIdsRaw.split(",").filter(id => id.trim() !== "");

          const contentBlock = document.querySelector("#monsterInfoContent .content");
          contentBlock.querySelectorAll(".info-row[data-skill='true']").forEach(e => e.remove());

          skillIds.forEach((skillId, index) => {
            let skillName = "無技能";
            let skillDesc = "";
            if (typeof skilldesc !== "undefined" && skilldesc[skillId]) {
              skillName = skilldesc[skillId].name || "無名稱";
              skillDesc = skilldesc[skillId].description || "";
            }

            const skillRow = document.createElement("div");
            skillRow.className = "info-row";
            skillRow.setAttribute("data-skill", "true");

            const label = document.createElement("div");
            label.className = "info-label";
            label.textContent = skillIds.length > 1 ? `Normal Skill ${index + 1}` : "Normal Skill";

            const value = document.createElement("div");
            value.className = "info-value";
            value.textContent = skillName;
            value.title = skillDesc;

            skillRow.appendChild(label);
            skillRow.appendChild(value);
            contentBlock.appendChild(skillRow);
          });
        }

        document.getElementById('monsterInfoModal').style.display = 'flex';
      } else {
        alert("⚠️找不到怪物資料！");
      }
    })
    .catch(err => {
      console.error("載入 monster.json 發生錯誤：", err);
    });
}
  </script>
  <script>
   function updateMonsterIcons(monsterElement, monster) {
	  const attributeId = parseInt(monsterElement.getAttribute('data-attribute'), 10);
	  const raceId = parseInt(monsterElement.getAttribute('data-race'), 10);

	  const attributeName = attributeMapping[attributeId] || 'unknown';
	  let raceName = raceMapping[raceId] || 'unknown'; // Use let here if needed

	  // Handle race 6 and 7 explicitly
	  if (raceId === 6) {
		raceName = 'evolve';
	  } else if (raceId === 7) {
		raceName = 'level';
	  }

	  const monsterIdElement = document.getElementById('monsterID');
	  monsterIdElement.textContent = monsterElement.getAttribute('data-name') + " (ID: " + monster.id + ")";

	  const attributeIcon = document.createElement("img");
	  attributeIcon.src = `https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/${attributeName}.png`;
	  attributeIcon.alt = "屬性圖示";
	  attributeIcon.style.width = '24px';
	  attributeIcon.style.height = '24px';
	  attributeIcon.style.marginLeft = '8px';

	  const raceIcon = document.createElement("img");
	  // Use custom URLs for race 6 and 7
	  if (raceId === 6) {
		raceIcon.src = 'https://i.postimg.cc/zbDvRhPc/evolve.png';
	  } else if (raceId === 7) {
		raceIcon.src = 'https://i.postimg.cc/cKB6HhT3/level.png';
	  } else {
		raceIcon.src = `https://d1h5mn9kk900cf.cloudfront.net/toswebsites/checkup/tag-selectors/${raceName}.png`;
	  }

	  raceIcon.alt = "種族圖示";
	  raceIcon.style.width = '24px';
	  raceIcon.style.height = '24px';
	  raceIcon.style.marginLeft = '4px';

	  // Append the icons to the element
	  monsterIdElement.appendChild(attributeIcon);
	  monsterIdElement.appendChild(raceIcon);
	}
  </script>
  <script>
   document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".monster").forEach(monster => {
    monster.addEventListener("click", () => {
      const monsterId = monster.getAttribute("data-id");
      fetchMonsterInfo(monsterId, monster);
    });
  });
});
  </script>
 </body>
</html>
